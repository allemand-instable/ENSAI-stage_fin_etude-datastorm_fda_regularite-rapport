\chapter{Applications et comparaison des diff√©rentes m√©thodologies}
\minitoc%

\warn{toute la r√©daction de ce chapitre est une √©bauche grossi√®re, destin√©e √† former le squelette du rapport. Le processus de r√©daction est it√©ratif sur toute la dur√©e du stage. avancement du stage : 3 / 6 mois}

\begin{itemize}
    \item Noyau de lissage : Epanechnikov :
    $$K : x \mapsto \frac 3 4 (1 - u^2)\cdot \indicatrice{|x| \leq 1}$$
    \item Kernel d'auto-r√©gression : 
    $$\beta : (s,t) \mapsto \frac 9 4 \sqrt{s(1-s)} \times t$$
    \item m√©thode d'approximation d'int√©grale : m√©thode des points m√©dians (Newton-Cotes)
    \item Processus de r√©f√©rence : Brownien multi-Fractionnaire
    % TODO : citer le papier de g√©n√©ralisation du mouvement brownien multi fractionnaire ( how rich + ...)
    \citationrequise
    \item M√©thodes de lissage : 
    \begin{itemize}
        \item Nadaraya-Watson
        \item base B-Spline
        \item base Ondelettes
    \end{itemize}
    \item m√©thode de s√©lection des hyper-param√®tres de lissage :
    \begin{itemize}
        \item NW : s√©lection de la largeur de bande $h$ par validation crois√©e
        \item B-Spline : s√©lection du nombre de noeuds par GCV
        \item Ondelettes : d√©termination de la base optimale par validation crois√©e
    \end{itemize}
\end{itemize}

% Please add the following required packages to your document preamble:
% \usepackage[table,xcdraw]{xcolor}
% If you use beamer only pass "xcolor=table" option, i.e. \documentclass[xcolor=table]{beamer}
\begin{table}[]
    \begin{tabular}{l|l|ll|l|}
    \cline{2-5}
    \textbf{}                                                         & \textbf{nombre de valeurs test√©es} & \multicolumn{1}{l|}{\textbf{de}} & \textbf{jusqu'√†}         & \textbf{valeur}          \\ \hline
    \multicolumn{1}{|l|}{\textit{\textbf{$\Delta$}}}                  & $30$                               & $0.01$                        & $0.2$                   & \cellcolor[HTML]{C0C0C0} \\
    \multicolumn{1}{|l|}{\textit{\textbf{$\lambda$}}}                 & $30$                               & $30$                             & $480$                    & \cellcolor[HTML]{C0C0C0} \\
    \multicolumn{1}{|l|}{\textit{\textbf{$N$}}}                       & $4$                                & $100$                            & $400$                    & \cellcolor[HTML]{C0C0C0} \\
    \multicolumn{1}{|l|}{\textit{\textbf{fonction de Hurst ($H_t$)}}} & $2$                                & logistique                       & escalier                 & \cellcolor[HTML]{C0C0C0} \\
    \multicolumn{1}{|l|}{\textit{\textbf{nb simulations MC}}}         & \cellcolor[HTML]{C0C0C0}           & \cellcolor[HTML]{C0C0C0}         & \cellcolor[HTML]{C0C0C0} & $200$                    \\ \hline
    \end{tabular}
    \caption{Hyper-param√®tres de la simulation Monte-Carlo}
    \label{tab:hyperparam-mc}
    \end{table}
\section{Donn√©es simul√©es}


\subsection{Objectifs de la simulation}

% TODO : donner les r√©sultats th√©oriques d√©riv√©s par Hassan

Si la th√©orie d√©velop√©e par MPV assure la convergence ponctuelle des estimateurs de r√©gularit√© $\hat L_t, \hat H_t$ en fonction de $\hat \theta(u,v)$ ($u,v \in [t \pm \frac \Delta 2 ]$), celle ci se fait √† $\Delta$" donn√©. Le praticien devra donc choisir un $\Delta$, que l'on esp√®re judicieux, c'est √† dire du bon choix de la taille du voisinage de $t$ pour effectuer les calculs des estimateurs de r√©gularit√©.

En effet ~\cite[Thm 1]{maissoro-SmoothnessFTSweakDep} donne une borne de concentration pour la convergence de l'estimateur de $H_t$ propos√© :

\flask{

en posant $\mathfrak a_{N, \Delta}^{H_0}(\varphi) \isdef N \varphi^2 \Delta^{4 H_0}$

$$\mathds{P}\left(|{\widehat{H}}_{0}-H_{0}|>\varphi\right)\leq{\frac{{\mathfrak{f}}_{0}}{a_{N, \Delta}^{H_0}(\varphi)}}+4\mathfrak{b}\exp\left(-\mathfrak g_0\mathfrak a_{N, \Delta}^{H_0}(\varphi)\right)$$

$$\mathds{P}\left(\left|{\widehat{L_{t}^{2}}}-L_{t}^{2}\right|>\psi\right)\leq{\frac{\mathfrak c_0}{a_{N, \Delta}^{H_0 \emphcolor{+ \varphi}}(\psi)}}
+{\frac{\mathfrak{f_{0}}}{\mathfrak a_{N, \Delta}^{H_0}(\varphi)}}
+\mathfrak b\left[4\mathrm{exp}\left(-\mathfrak{g_{0}}\mathfrak a_{N, \Delta}^{H_0}(\varphi)\right)
+\mathrm{exp}\left(-\mathfrak{l_{0}}\mathfrak a_{N, \Delta}^{H_0 \emphcolor{+ \varphi}}(\psi)\right)\right]$$

}

Au moment o√π ce rapport est r√©dig√© l'expression de $\Delta$ comme une fonction de param√®tres estimables n'est pas encore connue. C'est pourquoi l'on souhaite effectuer des simulations en faisant varier diff√©rents param√®tres afin d'essayer d'intuiter la forme de l'expression de $\Delta$ comme une fonction de param√®tres estimables par le praticien.

% ‚ö†Ô∏è citer le papier de Hassan 
\citationrequise

\subsection{Simulation d'un processus Brownien (multi)-Fractionnaire}

Afin d'analyser le comportement de l'hyper-param√®tre $\Delta$ en fonction de diff√©rentes quantit√©s estimables ( nombre moyen d'observation par trajectoire, nombre de trajectoires, \dots ), des simulations de s√©ries temporelles de mouvements browniens multi-fractionnaires ont √©t√© effectu√©es. 

\question{ Pourquoi simuler en particulier des Mouvements Browniens Multi-Fractionnaires (mfBM) ?}

% üí° on connait sa r√©gularit√© exactement

% üí° il est localement holderien non d√©rivable

% üí° la classe des mouvements brownien multi-fractionnaires est riche, en terme de processus al√©atoires repr√©sentables

\citer{
\textbf{source : } \cite{mfbm-howrich}

There are non-constant functions $H(t)$ for which the correlation structure of the MBM processes depends non-trivially on the value of $(a_+,a_-)$ and hence, even for a given function $H(t)$, there are an infinite number of MBM processes with essentially different distributions.}


LE FAR (exemple 1 papier hassan) h√©rite de la r√©gularit√© du brownien multi fractionnaire, ce qui montre que la classe des processus sur lequel travaille hassan n'est pas vide

il est suffisant que la r√©gularit√© du noyau du FAR soit de r√©gularit√© sup√©rieure √† celle du brownien, ce qui est de toute fa√ßon r√©guli√®rement le cas


\subsection{Optimisation Algorithmique}

\subsubsection{G√©n√©ration du bruit blanc}

pour g√©n√©rer un processus sous gaussien il nous faut inverser la matrice de covariance, qui dans notre a une dimension de :

$\underbracket{\dim \vec\Delta}_{50} \times \underbracket{3}_{t_1 / t_2 / t_3} \times \underbracket{n_{points\_estim}}_{6} + \underbracket{n_{Grid\_\int}}_{100} + \underbracket{\lambda}_{\leq 480} \leq \underbracket{1000}_{fixe} + \underbracket{480}_{pts \, aleat}$

on peut donc gagner du temps de calcul en inversant une unique fois la covariance restreinte aux points qui ne sont pas al√©atoires et pr√©sents sur chaque courbe, ce qui peut faire la diff√©rence quand on a 400 courbes.

en posant : 

$U \isdef B \inverse D$

$V \isdef C \inverse A$


on obtient l'inversion de la matrice par blocs avec l'algorithme suivant :
$$
\begin{bmatrix}
A & B \\
C & D
\end{bmatrix}^{-1}
=
\begin{bmatrix}
\inverse{(A - UC)} & 0 \\
0 & \inverse{(D - VB)}
\end{bmatrix}
\begin{bmatrix}
I & - U \\
- V & I
\end{bmatrix}
$$

dans notre cas 
$$\Sigma = \begin{bmatrix}
    \Sigma_{[t \neg\textsf{ alea}]} & \Sigma_{[\textsf{alea} / \neg \textsf{ alea}]}
    \\ \Sigma^T_{[\textsf{alea} / \neg \textsf{ alea}]}
     & \Sigma_{[t \textsf{ alea}]} 
\end{bmatrix}$$

ce qui donnerait la formule d'inversion par bloc suivante :

$$
\inverse \Sigma
=
\begin{bmatrix}
    \inverse{(\Sigma_{[t \neg\textsf{ alea}]} - UC)} & 0 \\
    0 & \inverse{(\Sigma_{[t \textsf{ alea}]} - VB)}
    \end{bmatrix}
    \begin{bmatrix}
    I & - U \\
    - V & I
    \end{bmatrix}
$$

avec : 

$U = \Sigma_{[\textsf{alea} / \neg \textsf{ alea}]} \inverse {\Sigma_{[t \textsf{ alea}]}} $

$V = \Sigma^T_{[\textsf{alea} / \neg \textsf{ alea}]} \inverse {\Sigma_{[t \neg\textsf{ alea}]}}$

\subsubsection{Int√©grale}

$$X_{n+1}(t) = \int\limits_{[0,1]} \beta(u,t) \cdot \left[ X_{n-1}(u) - \mu(u)\right]du + \varepsilon_n$$

il est important lorsque l'on effectue autant de simulations d'avoir des calculs efficients pour limiter le temps de calcul.

Parmi les m√©thodes d'approximation d'int√©grale classiques se trouvent les m√©thodes des rectangles, trap√®ze et de Newton-Cotes. On se basera sur la m√©thode de Newton Cotes d'ordre 0 aussi appel√©e des points m√©dians pour l'avantage suivant : elle permet d'avoir √† √©valuer le Brownien fractionnaire en un seul point, ce qu'il signifie qu'on a besoin de g√©n√©rer qu'un seul point par sous-intervalle pour calculer l'int√©grale, avec une approximation d'ordre 1 (ie, exacte pour un polyn√¥me de degr√© $\leq 1$), plus pr√©cise que la m√©thode des rectangles √† gauche et m√™me des trap√®zes.

$$\tilde E[g_{k}, g_{k+1}] = \frac{(g_{k+1}-g_k)^3}{12}f ^{''}(\eta_{k,k+1}) = \frac{(\frac{k+1} G - \frac k G )^3}{12}f ^{''}(\eta_{k,k+1}) = \frac{f ^{''}(\eta_{k,k+1})}{12G^3}$$

$$\tilde E = \frac 1 {12 G^3} \left[\sum_{k=0}^{G-1}f ^{''}(\eta_{k, k+1})\right] \leq \frac{\sup\limits_{[0,1]} f^{''} }{12 G^2}= \mathcal O\left( \frac 1 {G^2} \right)$$

Bien que nous ne manipulons pas des fonctions 2 fois d√©rivables, la borne d'approximation nous donne une id√©e de l'erreur qui sera commise en utilisant cette m√©thode.




\section{Donn√©es R√©elles}

\subsection{Courbes de charge √©olienne}

\subsection{Donn√©es Hydrauliques}

\section{Conclusion sur l'efficacit√© des diff√©rentes m√©thodologies}