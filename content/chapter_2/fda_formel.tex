\subsubsection{Définition formelle}

Pour éviter d'alourdir les notations, on se place dans le cas où les fonctions sont à valeurs dans $\mathds R$ et à support sur un intervalle fermé $I$ de $\mathds R$. Toutefois, on peut très bien considérer des fonctions à valeurs dans $\mathds R^d$ et à support sur un compact $K$ de $\mathds R^p$ sans perte de généralités.

\begin{definition}[données fonctionnelles ]

    On appelle données fonctionnelles, un échantillon $\famfinie x 1 n$ de fonctions continues $x_i : I \rightarrow \R d$ issues d'un processus $X$ défini comme ci-dessous :

    $$X : 
    \begin{array}{ccc}
        \Omega & \longrightarrow & \mathcal C(I, \mathds R)
        \\
        \omega & \longmapsto & X(\omega) = x 
    \end{array}
    $$

\end{definition}

\subsubsection{Résultats importants}

On énonce désormais le théorème central de l'analyse de données fonctionnelles qui n'est autre que la décomposition dans la base FPCA de notre processus.

\begin{rem}
    on notera que dans le cadre des données fonctionnelles, on ne travaille pas de façon générale avec la covariance :
    
    $$C_X : (s,t) \mapsto \esperance{ (X - \mu)(s) \cdot (X - \mu)(t) }$$
    
    On travaille plutôt avec l'\textbf{opérateur} covariance :
    $$f \mapsto \int\limits_I f(u)C_X(u, \cdot \,) \,du$$ 
    
    C'est parceque cet opérateur est linéaire continu (car Hilbert-Schmidt donc borné pour la norme d'opérateur) symétrique semi-défini positif (pour le produit scalaire de $\mathds L^2$) et que l'on peut donc en faire une décomposition spectrale sur une base orthonormale de vecteurs propres associés à des valeurs propres positives. Cette décomposition est à la base des approximations que le praticien effectuera ainsi qu'à la base de la dérivation de nombreux théorèmes et propriétés.
\end{rem}

\bigskip

Etant donné que l'on traîte des données fonctionnelles, on considère la géométrie usuelle de $\mathds L^2$ et on note ainsi 

$$\prodscalselon \cdot \cdot {\mathds L^2}: \begin{array}{ccc}
    \mathds L^2 \times \mathds L^2 & \longrightarrow & \mathds R
    \\
    (f,g) & \longmapsto & \int f(u)g(u) \, du 
\end{array}$$ 

le produit scalaire que l'on considère pour manipuler les données fonctionnelles.

% https://stackoverflow.com/a/4008463 : no page break
\begin{minipage}{\textwidth}
\begin{thm}[Karhunen-Loeve]
    \emph{référence :} ~\cite[pages : 238-239-241]{kokoszka2017introduction}

    \textbf{Hypothèses :}

    $$
    \boxed{
    \begin{array}{ll}
        \textsf{\faCaretSquareRight} & X \in \mathds L^2( \Omega, \mathcal C(I, \mathds R)) 
        \\ \\
        \textsf{\faCaretSquareRight} & \textsf{covariance : } C : \begin{array}{ccc}
            \mathds L^2( \Omega, \mathcal C(I, \mathds R)) & \longrightarrow & \mathcal C(I^2, \mathds R)
            \\
            X & \longmapsto & C_X
        \end{array}
        \\ \\
        & \textsf{ie : } C_X : (s, t) \mapsto C_X(s,t) \textsf{ est continue}
        \\ \\
        \textbf{\faIcon{asterisk}} & \textsf{opérateur covariance} \, c_X[ \, \cdot \, ] : \begin{array}{ccc}
            \mathcal C(I, \mathds R) & \longrightarrow & \mathcal C(I, \mathds R)
            \\
            f & \longmapsto & \int_I f(s) C_X(s, \cdot \, ) \, ds \end{array}
        \\\\
        \textsf{\faCaretSquareRight} & \textsf{valeurs propres ordonnées : } \forall p \geq 1, \lambda_{p+1} \leq \lambda_p \quad\quad \lambda_p, \lambda_{p+1} \in \operatorname{sp}(c_X)
        \\ \\
        \textbf{\faIcon{asterisk}} & \textsf{on pose } \overrightarrow{sp}_{\orthonormal}^{[1,p]}(c_X) \isdef \left\{ \phi_k \in \overrightarrow{sp}_{\orthonormal}( \, c_X \, ) \textsf{ associé à }  \lambda_k, k \in \intervaleint 1 p \, \right\}
    \end{array} 
    }
    $$

    \textbf{alors :}
    $$
    \boxed{
    \begin{array}{cc}
        \textsf{\faCaretSquareRight} & 

            \forall p \geq 1 
            \quad
            \argmin\limits_{u_k \in \mathcal C(I, \mathds R)} \mathds E \left\Vert X - \sum\limits_{k=1}^p \prodscalselon {X - \mu} {u_k} {\mathds L^2} u_k \right\Vert^2 = \overrightarrow{sp}_{\orthonormal}^{[1,p]}( \, c_X \, )

        \\
        \\
        \textsf{\faCaretSquareRight} & X = \mu + \sum\limits_{k=1}^{+\infty} \prodscal {X - \mu} {\phi_k} \phi_k
        \\
        &
        \\
         &\textsf{avec } \phi_k \in \overrightarrow{sp}_{\orthonormal}( \, c_X \, )
    \end{array}
    }
    $$

    \label{thm:KL}
\end{thm}
\end{minipage}

\begin{rem}
    pour pouvoir ordonner les valeurs propres dans l'ordre décroissant, et sélectionner les composantes principales les plus informatives, il faut pouvoir réarranger l'ordre de la somme. Pour cela il faut que les valeurs propres forment une famille sommable, une condition suffisante et souvent utilisée est que $\mathds E \Vert X \Vert^2 < \infty$ 
\end{rem}

\begin{rem}
    la propriété de la section précédente sur l'aspect économe de la base FPCA découle directement de l'assertion $\forall p \geq 1 
    \quad
    \argmin\limits_{u_k \in \mathcal C(I, \mathds R)} \mathds E \left\Vert X - \sum\limits_{k=1}^p \prodscal {X - \mu} {u_k} u_k \right\Vert^2 = \overrightarrow{sp}_{\orthonormal}^{[1,p]}( \, c_X \, )$ dans le théorème de Karhunen-Loeve.
\end{rem}


